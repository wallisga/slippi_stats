{% extends "base.html" %}

{% block layout_css %}
<!-- Component CSS for player pages -->
<link rel="stylesheet" href="{{ url_for('static', filename='css/components/cards.css') }}">
<link rel="stylesheet" href="{{ url_for('static', filename='css/components/tables.css') }}">
<link rel="stylesheet" href="{{ url_for('static', filename='css/components/player_title.css') }}">
<link rel="stylesheet" href="{{ url_for('static', filename='css/components/character_icons.css') }}">
{% endblock %}

{% block nav_items %}
<li class="nav-item dropdown">
    <a class="nav-link dropdown-toggle active" href="#" id="playerDropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
        Players
    </a>
    <ul class="dropdown-menu" aria-labelledby="playerDropdown">
        <li><a class="dropdown-item" href="/players">Player Index</a></li>
        {% if player_code %}
        <li><hr class="dropdown-divider"></li>
        <li><h6 class="dropdown-header">{{ player_code }}</h6></li>
        <li><a class="dropdown-item player-link" data-path="/player/" data-code="{{ player_code }}" data-view="basic" href="#">Basic Profile</a></li>
        <li><a class="dropdown-item player-link" data-path="/player/" data-code="{{ player_code }}" data-view="detailed" data-suffix="/detailed" href="#">Detailed Stats</a></li>
        {% endif %}
    </ul>
</li>
<li class="nav-item">
    <a class="nav-link {% if '/download' in request.path %}active{% endif %}" href="/download">Download</a>
</li>
{% endblock %}

{% block nav_extras %}
<form class="d-flex navbar-search" id="playerSearchForm">
    <input class="form-control me-2" type="search" placeholder="Find Player..." aria-label="Search" id="playerCodeInput">
    <button class="btn btn-outline-light" type="submit"><i class="bi bi-search"></i></button>
</form>
{% endblock %}

{% block content_wrapper %}
<div class="container mt-4">
    <!-- Player Title Component Container -->
    <div id="player-title-container">
        <!-- Title will be generated by JavaScript component -->
    </div>
    
    <!-- Player data as JSON scripts (avoids HTML attribute length limits) -->
    <script type="application/json" id="player-data">
    {
        "playerCode": {{ (player_code | tojson) if player_code is defined else '""' }},
        "stats": {{ (stats | tojson) if stats is defined else '{}' }},
        "recentGames": {{ (recent_games | tojson) if recent_games is defined else '[]' }}
    }
    </script>
    
    {% block content %}{% endblock %}
</div>
{% endblock %}

{% block layout_js %}
<!-- Component JS for player pages - PROPER LOADING ORDER -->
<script src="https://cdn.jsdelivr.net/npm/chart.js@3.9.1/dist/chart.min.js"></script>
<script src="{{ url_for('static', filename='js/components/character_icons.js') }}"></script>
<script src="{{ url_for('static', filename='js/components/search.js') }}"></script>
<script src="{{ url_for('static', filename='js/components/player_dropdown.js') }}"></script>
<script src="{{ url_for('static', filename='js/components/player_title.js') }}"></script>
{% endblock %}